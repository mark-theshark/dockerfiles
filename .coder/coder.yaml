version: 0.2
workspace:
  type: kubernetes
  specs:
    kubernetes:
      image:
        value: index.docker.io/codercom/enterprise-base:ubuntu
      container-based-vm:
        value: true
      cpu: 
        value: 2
      memory:
        value: 2 
      disk:
        value: 10
      gpu-count:
        value: 0
      labels:
        value:   
          com.coder.custom.chargeback: "container_team"
  configure:
    start:
      value:
        - name: "set ssh keys and clone and build (dependencies) for dockerfiles project"
          directory: /home/coder/
          shell: /bin/bash
          command: |
            ssh-keyscan -t rsa github.com >> ~/.ssh/known_hosts
            REPO_1_PATH=$HOME/dockerfiles
            if [ -d $REPO_1_PATH ]; then
              echo 'dockerfiles repo already exists - skip clone'
            else
              git clone git@github.com:mtm20176/dockerfiles.git 
            fi   
        - name: "install docker-compose"
          directory: /home/coder/
          shell: /bin/bash
          command: |
            sudo curl -L "https://github.com/docker/compose/releases/download/1.28.5/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
            sudo chmod +x /usr/local/bin/docker-compose            
        - name: "install fzf fuzzy find"
          directory: /home/coder/
          shell: /bin/bash
          command: |
            sudo apt update
            sudo apt install fzf
        - name: "install vim editor"
          directory: /home/coder/
          shell: /bin/bash
          command: sudo apt install vim              
  dev-urls:
    value:
      - name: fifthsterapp
        port: 3000
        scheme: http
        access: org